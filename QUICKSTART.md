# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –±—ã—Å—Ç—Ä–æ–º—É —Å—Ç–∞—Ä—Ç—É

## –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- pip
- git

## –ù–∞ Windows (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/littlefishily/smarthome.git
cd smarthome
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
python -m venv venv
venv\Scripts\activate
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 4. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
python main.py
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:8000

## –ù–∞ Ubuntu (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤

```bash
sudo apt-get update
sudo apt-get install -y python3 python3-pip python3-venv git
```

### 2. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
git clone https://github.com/littlefishily/smarthome.git
cd smarthome

sudo chmod +x install.sh
sudo ./install.sh
```

### 3. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞

```bash
sudo systemctl start smarthome
sudo systemctl status smarthome
```

## Docker (–≤—Å—ë –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ)

### 1. Build –æ–±—Ä–∞–∑–∞

```bash
docker build -t smarthome:latest .
```

### 2. –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```bash
docker run -d \
  -p 8000:8000 \
  -p 5020:5020 \
  -v $(pwd)/config:/etc/smarthome \
  --device=/dev/ttyUSB0 \
  --name smarthome \
  smarthome:latest
```

### 3. –° docker-compose

```bash
docker-compose up -d
```

## –ü–µ—Ä–≤—ã–µ —à–∞–≥–∏

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: http://localhost:8000 (–∏–ª–∏ http://<IP>:8000)

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–µ—Ç–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**:
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏–º—è —Ö–æ—Å—Ç–∞
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ IP –∞–¥—Ä–µ—Å

3. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ RTU —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞**:
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Modbus RTU"
   - –£–∫–∞–∂–∏—Ç–µ –ø–æ—Ä—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä /dev/ttyUSB0)
   - –ù–∞–∂–º–∏—Ç–µ "–ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è"

4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ TCP —Å–µ—Ä–≤–µ—Ä**:
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Modbus TCP"
   - –ù–∞–∂–º–∏—Ç–µ "–ó–∞–ø—É—Å—Ç–∏—Ç—å"
   - –î—Ä—É–≥–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Å–º–æ–≥—É—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –ø–æ TCP

5. **–ß–∏—Ç–∞–π—Ç–µ/–ø–∏—à–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ**:
   - –ù–∞ –≤–∫–ª–∞–¥–∫–µ RTU –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º—É –¥–ª—è —á—Ç–µ–Ω–∏—è –∏ –∑–∞–ø–∏—Å–∏
   - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ API endpoints

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞ (systemd)
sudo systemctl status smarthome

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
sudo journalctl -u smarthome -f

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
sudo systemctl restart smarthome

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤
netstat -tlnp | grep 5020
netstat -tlnp | grep 8000
```

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### RTU –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –ø–æ—Ä—Ç–æ–≤
ls -la /dev/tty*

# –î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø—Ä–∞–≤–∞ –Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –ø–æ—Ä—Ç
sudo usermod -a -G dialout $USER
```

### –ü–æ—Ä—Ç –∑–∞–Ω—è—Ç
```bash
# –ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å, –∑–∞–Ω–∏–º–∞—é—â–∏–π –ø–æ—Ä—Ç
sudo lsof -i :8000
sudo lsof -i :5020

# –£–±–µ–π—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
sudo kill -9 <PID>
```

### –õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
```bash
# –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
tail -f /var/log/smarthome/controller.log

# –ñ—É—Ä–Ω–∞–ª —Å–∏—Å—Ç–µ–º—ã
sudo journalctl -u smarthome -f
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –≤:
- **Ubuntu**: `/etc/smarthome/config.json`
- **Windows/Dev**: `./config/config.json`

–ú–æ–∂–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, —Ç–∞–∫ –∏ –Ω–∞–ø—Ä—è–º—É—é.

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å curl

```bash
# –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
curl http://localhost:8000/api/system/status

# –°–µ—Ç–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
curl http://localhost:8000/api/network/config

# –°—Ç–∞—Ç—É—Å RTU
curl http://localhost:8000/api/modbus/rtu/status

# –°—Ç–∞—Ç—É—Å TCP —Å–µ—Ä–≤–µ—Ä–∞
curl http://localhost:8000/api/modbus/tcp/status

# –ß—Ç–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
curl -X POST http://localhost:8000/api/modbus/rtu/read \
  -H "Content-Type: application/json" \
  -d '{"slave_id": 1, "type": "holding_registers", "start_addr": 0, "quantity": 10}'
```

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [README.md](README.md)
- API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [API.md](docs/API.md) (–µ—Å–ª–∏ –µ—Å—Ç—å)
- –ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏: [docs/examples/](docs/examples/)

---

–ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å —Ä–∞–±–æ—á–∏–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —É–º–Ω–æ–≥–æ –¥–æ–º–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Modbus! üöÄ
